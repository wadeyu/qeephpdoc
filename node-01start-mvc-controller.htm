<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>QeePHP/FleaPHP 开源开发框架 - 起源科技开源社区|中国领先的 PHP 开源解决方案提供商</title>
<link rel="shortcut icon" href="/favicon.ico">
<link rel="stylesheet" type="text/css" href="base.css" tppabs="http://qeephp.com/qeephp/base.css" />
<link rel="stylesheet" type="text/css" href="jquery-ui-081120.css" tppabs="http://qeephp.com/qeephp/jquery-ui-081120.css" />
<script type="text/javascript" src="jquery-1.2.6.min.js" tppabs="http://qeephp.com/js/jquery-1.2.6.min.js"></script>
<script type="text/javascript" src="jquery-ui-1.5.3-081202.min.js" tppabs="http://qeephp.com/qeephp/jquery-ui-1.5.3-081202.min.js"></script>
<script type="text/javascript">
$(document).ready(function() {
});
</script>
</head>
<body>

<div id="page-wrapper">

<!-- header -->
<div id="header">
  <div class="container clearfix">
    <div id="header_nav">
      <ul id="navigation">
        <li class="first"><a href="projects.htm" tppabs="http://qeephp.com/projects">开源项目与插件</a></li>
        <li><a href="cases.htm" tppabs="http://qeephp.com/cases">应用展示</a></li>
        <li><a href="framework.htm" tppabs="http://qeephp.com/framework">框架</a></li>
        <li><a href="docs.htm" tppabs="http://qeephp.com/docs">文档</a></li>
	  </ul>
    </div>
  </div>
</div>
<!-- /header -->


<!-- core -->
<div id="core" class="clearfix">
  <div class="container clearfix">

    

    <!-- 整页 -->

    <div id="fullpage" class="contents">

      
<div class="guide-section">

  <div class="guide-header">
    <span class="nav">
      <a href="index-4.htm" tppabs="http://qeephp.com/docs/">文档索引</a>
      &raquo;
      <a href="index-5.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/">QeePHP 快速入门</a>
      &raquo;
      <a href="node-01start.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-01start">起步</a>
      &raquo;
      控制器    </span>
  </div>

  <div class="guide-section">
    <div class="guide-sidebar">
      
<h2>目录</h2>


<h3><a href="node-01start.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-01start">起步</a></h3>


<ul>
    <li>
    <a href="node-01start-environment.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-01start-environment" subject="准备开发环境">准备开发环境</a>
  </li>
    <li>
    <a href="node-01start-creating-app.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-01start-creating-app" subject="创建应用程序">创建应用程序</a>
  </li>
    <li>
    <a href="node-01start-dirstructure.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-01start-dirstructure" subject="目录结构">目录结构</a>
  </li>
    <li>
    <a href="node-01start-mvc.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-01start-mvc" subject="MVC 模式">MVC 模式</a>
  </li>
    <li>
    <a href="node-01start-mvc-startup.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-01start-mvc-startup" subject="MVC 模式的启动">MVC 模式的启动</a>
  </li>
    <li>
    <a href="node-01start-mvc-controller.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-01start-mvc-controller" subject="控制器">控制器</a>
  </li>
  
</ul>



<h3><a href="node-02development.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-02development">开始开发</a></h3>


<ul>
    <li>
    <a href="node-02development-database.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-02development-database" subject="创建数据库">创建数据库</a>
  </li>
    <li>
    <a href="node-02development-yaml.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-02development-yaml" subject="YAML 入门">YAML 入门</a>
  </li>
    <li>
    <a href="node-02development-configs.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-02development-configs" subject="修改配置文件">修改配置文件</a>
  </li>
  
</ul>



<h3><a href="node-03automation.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-03automation">使用自动化工具</a></h3>


<ul>
    <li>
    <a href="node-03automation-controller.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-03automation-controller" subject="创建控制器">创建控制器</a>
  </li>
    <li>
    <a href="node-03automation-model.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-03automation-model" subject="创建模型">创建模型</a>
  </li>
  
</ul>



<h3><a href="node-04thinking.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-04thinking">编写代码之前的思考</a></h3>


<ul>
    <li>
    <a href="node-04thinking-oo.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-04thinking-oo" subject="用对象来思考">用对象来思考</a>
  </li>
    <li>
    <a href="node-04thinking-analysis.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-04thinking-analysis" subject="需求分析">需求分析</a>
  </li>
    <li>
    <a href="node-04thinking-creating-models.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-04thinking-creating-models" subject="创建需要的模型">创建需要的模型</a>
  </li>
  
</ul>



<h3><a href="node-05users.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-05users">实现用户功能</a></h3>


<ul>
    <li>
    <a href="node-05users-register-ui.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-05users-register-ui" subject="用户注册（用户界面）">用户注册（用户界面）</a>
  </li>
    <li>
    <a href="node-05users-register-model.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-05users-register-model" subject="用户注册（完善模型）">用户注册（完善模型）</a>
  </li>
    <li>
    <a href="node-05users-register-code.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-05users-register-code" subject="用户注册（功能实现）">用户注册（功能实现）</a>
  </li>
    <li>
    <a href="node-05users-login.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-05users-login" subject="用户登录和注销">用户登录和注销</a>
  </li>
    <li>
    <a href="node-05users-change-passwd.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-05users-change-passwd" subject="修改密码">修改密码</a>
  </li>
  
</ul>



<h3><a href="node-06acl.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-06acl">访问控制</a></h3>


<ul>
    <li>
    <a href="node-06acl-why.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-06acl-why" subject="为什么要使用访问控制">为什么要使用访问控制</a>
  </li>
    <li>
    <a href="node-06acl-do.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-06acl-do" subject="实现访问控制">实现访问控制</a>
  </li>
  
</ul>



<h3><a href="node-07tasks.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-07tasks">实现任务管理</a></h3>


<ul>
    <li>
    <a href="node-07tasks-add.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-07tasks-add" subject="添加任务">添加任务</a>
  </li>
    <li>
    <a href="node-07tasks-edit.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-07tasks-edit" subject="修改和删除任务">修改和删除任务</a>
  </li>
    <li>
    <a href="node-07tasks-pagination.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-07tasks-pagination" subject="分页与最后的完善">分页与最后的完善</a>
  </li>
  
</ul>



<h3><a href="node-08routes.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-08routes">美化 URL</a></h3>


<ul>
    <li>
    <a href="node-08routes-router.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-08routes-router" subject="URL 路由是什么">URL 路由是什么</a>
  </li>
    <li>
    <a href="node-08routes-configs.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-08routes-configs" subject="启用 URL 路由">启用 URL 路由</a>
  </li>
    <li>
    <a href="node-08routes-rules.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-08routes-rules" subject="添加路由规则">添加路由规则</a>
  </li>
  
</ul>



<h3><a href="node-09review.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-09review">回顾</a></h3>


<ul>
    <li>
    <a href="node-09review-readmore.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-09review-readmore" subject="教程没有涉及的内容">教程没有涉及的内容</a>
  </li>
    <li>
    <a href="node-09review-improve.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-09review-improve" subject="进一步的改进">进一步的改进</a>
  </li>
  
</ul>



    </div>

    <div class="guide-contents formatted">
      
<h1>控制器</h1>

<p>控制器在 MVC
模式中充当了模型和视图的桥梁。控制器负责处理请求，并调用模型完成业务操作，最后返回适当的视图对象。而应用程序对象则执行视图对象来构造输出内容，并将输出内容返回给浏览器。</p>

<div class="figure"><img
src="start-mvc-controller-01.png" tppabs="http://qeephp.com/upload/docs/qeephp-quickstart/images/start-mvc-controller-01.png" alt=""
/>
	<p>控制器的职责</p>
</div>

<h2>控制器和动作方法</h2>

<p>通常，我们的应用程序会提供一系列的 URL
地址给用户。通过访问这些 URL
地址就可以使用应用程序的不同功能。例如“create.php”表示创建，而“edit.php”表示修改。由于
QeePHP 采用了 MVC
模式，所以我们不需要为每一个功能都编写一个单独的 PHP
文件。我们可以把一组相关的功能放到一个控制器中，而控制器的每一个<strong>动作方法</strong>就是一项独立的功能。</p>

<p>由于整个应用程序的所有功能都是通过入口文件来访问的。这要求我们通过不同的
URL
参数来指定要访问的控制器及动作方法。这样应用程序对象通过检查
URL
中的参数，就可以确定用户想调用的控制器和动作方法。</p>

<h2>通过 URL 参数指定控制器和动作</h2>

<p>我们来做个测试，修改 app/controller/default_controller.php
文件，加入：</p>

<pre class="php code"><span class="kw2">function</span> actionTest<span
class="br0">&#40;</span><span class="br0">&#41;</span>
<span
class="br0">&#123;</span>
    <span class="kw3">echo</span> <span
class="st0">&quot;OK, default 控制器的 test 动作被调用。&quot;</span><span
class="sy0">;</span>
<span class="br0">&#125;</span></pre>

<p>然后通过浏览器访问 <a
href="javascript:if(confirm('http://localhost:9000/todo/index.php?controller=default&action=test  \n\n���ļ�δ�� Teleport Pro ���أ���Ϊ ��λ����ʼ��ַ�����õı߽�����������·���С�  \n\n����Ҫ�ӷ�������������?'))window.location='http://localhost:9000/todo/index.php?controller=default&action=test'" tppabs="http://localhost:9000/todo/index.php?controller=default&action=test">http://localhost/todo/index.php?controller=default&action=test</a>
，即可看到我们在 actionTest() 动作方法中写入的文字。</p>

<div class="figure"><img
src="start-mvc-controller-02.png" tppabs="http://qeephp.com/upload/docs/qeephp-quickstart/images/start-mvc-controller-02.png" alt=""
/>
	<p>执行指定的控制器和动作</p>
</div>

<p>在上面的例子中，如果注意到 URL
地址中包含的“controller=default&amp;action=test”就会明白通过名为“controller”和“action”的参数，可以指定我们要调用的控制器和动作方法。</p>

<p>依此类推，http://localhost:9000/todo/index.php?<strong>controller=users</strong>&amp;<strong>action=create</strong>
这个 URL 指定了要访问 users 控制器的 create 动作方法。</p>

<h2>动作方法</h2>

<p>前面反复提到的动作方法是我们在控制器类中添加的特定方法。这些方法的名称都是以“action”开头，例如
actionTest()、actionIndex()
等。之所以要求必须以“action”开头，是为了避免用户从浏览器访问到控制器中不希望被外部访问的一些方法。</p>

<p>有一个特别的动作方法 actionIndex()
是控制器的默认动作。假如我们没有在 URL
参数中指定要调用的动作方法，那么就会调用控制器的
actionIndex() 动作方法。同理，如果没有在 URL
参数中指定要调用的控制器，就会调用 default
这个默认控制器。</p>

<h2>美化 URL</h2>

<p>可能读者朋友觉得上面的 URL
又臭又长，看上去难看，而且影响 SEO。不过没关系，QeePHP 的
URL 路由器可以让我们构造任意形式的 URL，这里举例使用的
URL 样式是默认样式。有关美化 URL
的内容会在本教程的后续部分说明。</p>

<blockquote>
	<p>默认 URL
	样式虽然不美观，但是兼容任何服务器环境。当服务器运行环境不支持
	URL
	路由器时，我们可以使用默认样式来保证应用程序可以正常工作。</p>
</blockquote>

<h2>总结</h2>

<p>总结一下：</p>

<ul>
	<li><strong>控制器</strong>
		<p>控制器是一个类，定义在 controller/
		目录中。文件名是“控制器名称_controller.php”，例如
		default_controller.php。</p>
	</li>

	<li><strong>控制器名称</strong>
		<p>控制器名称只能是 26 个字母和 10
		个数字组成，并且不区分大小写。</p>
	</li>

	<li><strong>动作方法</strong>
		<p>动作方法是控制器类中以“action”开头的方法，例如
		actionTest()。</p>
	</li>

	<li><strong>动作名称</strong>
		<p>只能是 26 个字母和 10
		个数字组成，并且不区分大小写。</p>
	</li>

	<li><strong>指定要调用的控制器和动作方法</strong>
		<p>URL 参数 controller 和 action
		分别用于指定要调用的控制器和动作方法。</p>
	</li>

	<li><strong>默认动作方法</strong>
		<p>未在 URL
		参数中指定要调用的动作方法时，将会调用控制器的
		actionIndex() 动作方法。</p>
	</li>

	<li><strong>默认控制器</strong>
		<p>未在 URL 参数中指定要调用的控制器时，将会调用 default
		这个默认控制器。</p>
	</li>
</ul>
    </div>

    <div class="nofloat"></div>
  </div>

  <div class="guide-footer">

    <table border="0" width="100%">
      <tr>
        <td align="left" width="200">
                    &laquo;
          <a href="node-01start-mvc-startup.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-01start-mvc-startup">MVC 模式的启动</a>
          
        </td>

        <td align="center">
          本章：<a href="node-01start.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-01start">起步</a>
          <br />
          <a href="index-5.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/">返回索引页</a>
        </td>

        <td align="right" width="200">
                    <a href="node-02development.htm" tppabs="http://qeephp.com/docs/qeephp-quickstart/node-02development">开始开发</a>
          &raquo;
                  </td>
      </tr>
    </table>

  </div>

</div>


    </div>

    <!-- 整页 -->



<div id="google-adsense-block720" style="margin: 10px auto 20px auto; width: 730px; height: 90px;"></div>


  </div>
</div>
<!-- /core -->

<!-- footer -->
<div id="footer">
  <div id="breadcrumbs">
    <p>
      <a href="index.htm" tppabs="http://qeephp.com/">返回首页</a>
      &nbsp;&nbsp;
      <a href="projects.htm" tppabs="http://qeephp.com/projects">开源项目与插件</a>
      &nbsp;&nbsp;
      <a href="cases.htm" tppabs="http://qeephp.com/cases">应用展示</a>
      &nbsp;&nbsp;
      <a href="framework.htm" tppabs="http://qeephp.com/framework">框架</a>
      &nbsp;&nbsp;
      <a href="docs.htm" tppabs="http://qeephp.com/docs">文档</a>
      &nbsp;&nbsp;
      <a href="index-1.htm" tppabs="http://qeephp.com/bbs/">论坛</a>
    </p>
  </div>
</div>
<!-- /footer -->

</div>
<!-- /page-wrapper -->

</body>
